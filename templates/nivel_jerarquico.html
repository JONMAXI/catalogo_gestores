{% extends "base.html" %}

{% block content %}
<h3 class="mb-4">Organigrama por Departamento</h3>

<div class="form-group mb-3">
    <label><strong>Selecciona un departamento:</strong></label>
    <select id="depSelect" class="form-control">
        <option value="">-- Seleccionar --</option>
        {% for id, nombre in departamentos.items() %}
            <option value="{{ id }}">{{ nombre }}</option>
        {% endfor %}
    </select>
</div>

<div id="resultado"></div>

<script>
document.getElementById("depSelect").addEventListener("change", function() {
    let dep_id = this.value;

    document.getElementById("resultado").innerHTML =
        "<p class='text-muted'>Cargando organigrama...</p>";

    if (!dep_id) {
        document.getElementById("resultado").innerHTML = "";
        return;
    }

    fetch("/nivel_jerarquico/" + dep_id)
        .then(res => res.text())
        .then(html => {
            document.getElementById("resultado").innerHTML = html;
        });
});
</script>

{% endblock %}
